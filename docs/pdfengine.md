PDF翻译受到智能排版以及文本翻译器的影响，所有文本翻译器得到的文档排版质量均是一样的，这里只重点介绍趣卡翻译的在线文档增强和常规高保真引擎智能排版算法。



## 在线文档增强（使用在线GPU显卡优化文档翻译）

<div align='center'><img  style="width:70%;" src="https://zanzhu.malizheng.com/manual/docs/oss/64012.png" /></div> 

在线文档增强这是一个人工智能大模型，专门用于提高学术论文和著作的文档排版和翻译质量，几乎可以完美解决常规高保真引擎翻译过程中遇到的各种瑕疵问题。该功能需要实时利用在线GPU显卡处理每页文档，会消耗大量GPU及带宽资源，同时为了保障您的隐私，在线文档增强上传的每页文档均在内存实时处理，处理结束后就完全消失，不会在服务器中被存储。

> 该模式可实时获取服务器端的最新效果，无需更新软件，如发现有问题的文档可以反馈进行优化。

|  <div style="width:50px">排版模型</div> | <div style="width:100px">描述</div> |说明 | 
|:---:|:---:|:---:|
| `通用增强` |  使用在线GPU识别和翻译PDF，几乎可以完美解决常规高保真所有瑕疵情况。| <img width='200'  src="https://zanzhu.malizheng.com/manual/docs/oss/WX20231002-195833@2x.png"/> <br>图片点击可放大 |
| `公式增强` |  如果你需要识别保留段落里的公式，切换成该模式即可。 |  <img width='200'  src="https://zanzhu.malizheng.com/manual/docs/oss/gongshi.png" /> <br>图片点击可放大  |
| `OCR增强` | 使用在线GPU强化`OCR翻译`。|  需提前管理OCR工具，OCR使用具体参考[OCR使用手册](manual/windowsocr.md)。|
| `内测公式` | `公式增强`的内测模式。| 可在公式增强效果不好的时候进行切换。 |
| `内测通用` | `通用增强`的内测模式。| 可在通用增强效果不好的时候进行切换。 |
| `内测OCR` | `OCR增强`的内测模式。|  可在通用OCR增强不好的时候进行切换。|
| `` | 在线GPU优化常规模式`RAB自动`的效果。| 通常无需选择该功能，只是一个占位符。 |

整体排版效果 ：公式增强



## 渲染方式（`深层渲染`、`常规渲染`和`浅层渲染`）
* `深层渲染:`适用想要保存多彩PDF，该模式可完美保留PDF背景和文字颜色，但一些较老的PDF或特殊的PDF可能会失败（失败后需要切换`常规渲染`或者`浅层渲染`即可），翻译后的结果可以进行选中和复制。
* `常规渲染:`在保证渲染成功率的基础上，尽可能保留PDF背景和文本颜色（但整体相对`深层渲染`来说差一些），翻译后的结果可以进行选中和复制。
* `浅层渲染:`100%保证成功率的基础上，尽可能保留PDF背景和文本颜色，翻译后的译文结果可以进行选中但不可以复制。
 
如果您仅仅是为了快速阅读，可以使用`常规渲染`或`浅层渲染`即可。具体的渲染效果排序： `深层渲染`>`常规渲染`>`浅层渲染`， 渲染成功率排序：`浅层渲染`>`常规渲染`>`深层渲染`。 

你也可开启**中间文件**按钮，趣卡翻译每次翻译完会生成`.qukaa`结尾的中间文件。**无论您之前使用了哪种渲染方式**，您都可以拖入`.qukaa`结尾的中间文件点击生成，就可以分别选择`深层渲染`、`常规渲染`和`浅层渲染`三种模式快速生成需要PDF，**而不需要重新翻译PDF** 。


## 常规高保真引擎（关闭在线文档增强后即可看到，无需在线GPU参与，效果要比前者差）

|  <div style="width:50px">排版模型</div> | <div style="width:100px">描述</div> |说明 | 
|:---:|:---:|:---:|
| `RAA自动` |  表格优先，建议手册类的PDF的使用。 | 该模式下可能会出现PDF段落里**单行句子被分割导致换行**的情况。|
| `RAA手动` |  表格优先，解决`学术论文`**双列PDF出现合并**的情况。<img  src="https://zanzhu.malizheng.com/manual/docs/oss/images/ssdfsdgdsgswxx.png" />| <img  src="https://zanzhu.malizheng.com/manual/docs/oss/images/1656691417490.jpg" />|
| `OCR翻译` | 在**PDF中文本无法选中和复制**的情况下，使用该模式。|  OCR使用具体参考[OCR使用手册](manual/ocr_settings.md)。|
| `RAB自动` | 整体排版比`RAA自动`更宽松些。| 相对行距过大更严谨一些。 |
| `学术论文` | 对绝大多数学术论文进行适配。| 但少数学术PDF可能还是会存在一些瑕疵。  |
| `专业著作` | 对绝大多数单栏专业著作进行适配。| 但少数著作PDF可能还是会存在一些瑕疵。 |
| `行距过大` | 用于解决PDF段落里**两行距离过多导致换行**的情况。| <div><img  src="https://zanzhu.malizheng.com/manual/docs/oss/images/gaodu.gif" /></div> |


>  `RAA手动`、`RAB自动`、`学术论文`、`专业著作`、`行距过大` 等模式均是为了解决`RAA自动`模式下出现的问题，`OCR翻译` 主要解决在**PDF中文本无法选中和复制**的情况。受到PDF非结构化数据的影响， 常规的高保真可能无法解决一些非常特殊的问题（如出现漏翻的情况），此时可以切换至在线文档增强模式，可以一键适用上述情况。


## 什么情况下要用使用OCR

PDF中文本无法选中和复制 **:有些非常老的PDF文档有一些页即使可以选中，但是复制出来的结果也是错误的。比如以下文档有些文本虽然能够选中，但是复制出来的文本是局部缺失的，需要进行图片识别，这类文档需要归类为**PDF中文本无法选中和复制**的情况。
<div align='center'><img  style="width:50%;" src="https://zanzhu.malizheng.com/manual/docs/oss/images/0255808a-61ff-4dc1-9967-fa394968d0fc.jpg" /></div> 

对于这类文档可以使用OCR翻译功能后：

<div align='center'><img  style="width:45%;" src="https://zanzhu.malizheng.com/manual/docs/oss/images/WX20220713-161439@2x.jpg" /><img  style="width:45%;" src="https://fanyi.qukaa.com/oss/images/20220713-1555162x.jpg" /></div> 

>左图是默认不进行OCR识别`RAA`的翻译效果，右图是经过OCR翻译后的效果。


## 双语裁剪参数
裁剪参数主要用于裁剪PDF文件使用，有些原始的PDF本身左右留有较多空白，合成双栏对照文件的时候，由于空白位置较多导致PDF中文字占比较少，对照文本之间距离较大。可以通过`裁剪参数`来**控制对照PDF翻译结果的左右和中间的空白**。

| 参数 | 描述 | 
| :---: | :--- |
| `保留宽度` | 用于合成PDF的左右和中间的空白宽度值，单位为像素px，为0将不保留宽度。 | 


## PDF其它设置

`前缀命名` 开启的话将会将名称放置在文件名前面，如果关闭的话，将会把文件名放置后面。

`实时保存` 开启后，将会每隔50页保存一下翻译结果到中间文件里。

`字体设置` 包含无衬线小米字体和楷两种供用户选择，如果自定义的话，需要将你的ttf字体拖拽到标准TTF和粗体TTF内。

`字体大小` 这里是指最小允许的字体大小，默认为`1`，程序会自动检测文本中字体大小，检测后的字体大小如果低于该设置值，就会强制设置为该值。

`中间文件` 这个将会在翻译的过程中保留中间结果，即使遇到程序崩溃，也不会丢失翻译结果，同时也有助于后续人工编辑工作，建议开启。

`RAA粗体`：文本识别算法RAA能够识别PDF中的粗体字体，如果希望存在加粗字体保留可以开启。

`行间距`：PDF文本行与行之间的距离，可以根据喜好设置，建议不要过大，可能会导致空白内容盛不下翻译结果。

`词数`：如果你想进行公式保留，可以根据这个词数来决定，正常一些公式作为一个模块，仅存在很少的单词，词数设置为1应该就能保留所有公式，前提要求翻译源语言不能设置自动识别。本程序利用6种语言的本地词库，对非词库内的词汇不进行翻译，一定程度加快翻译进度和获取更优的排版。

`偏移宽和高`通常用于解决在深度渲染情况下可能出现PDF偏移的问题。









